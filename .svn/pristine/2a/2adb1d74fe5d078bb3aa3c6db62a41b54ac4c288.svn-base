webpackJsonp([15],{1099:function(t,e,a){"use strict";function o(t){var e=t;return n([(new DOMParser).parseFromString(e,"text/xml").getElementsByTagName("node")[0]])}function n(t){var e=[];if(t&&"array"==i(t)&&t.length>0)for(var a=0;a<t.length;a++)e.push({name:t[a].name,path:String(t[a].value),node:n(t[a].node),key:String(a),icon:r[t[a].value]});else t&&"object"==i(t)&&e.push({name:t.name,path:String(t.value),node:n(t.node),key:(new Date).getTime(),icon:r[t.value]});return e}function i(t){var e=/\[object (\w+)\]/.exec(Object.prototype.toString.call(t));return e?e[1].toLowerCase():""}function s(t,e){var a=document.getElementById(t).innerHTML.replace(/<input/g,"<br");console.log(a);var o="";o+=".ckTable .editInput{display:none;border:none;outline:none;}",o+=".countTable{width:90%;border-color:#c6c6c6!important;margin:0 auto;border-collapse: collapse;}",o+=".countTable th{background-color:#ddeeff;border-color:!important;height:40px;line-height:40px;font-size:15px;font-weight:normal;text-align:center;}",o+=".countTable td{border-color:#c6c6c6!important;height:40px;min-height:40px;line-height:40px;font-size:13px;font-weight:normal;text-align:center;word-break: break-all;}",o+=".countTable tr:nth-child(odd){background-color:#fff;}.countTable tr:nth-child(even){background-color: #f8f8f8;}.countTable td .tips input{display:none;}";var n='<html><head><meta charset="UTF-8"><style type="text/css">'+o+"</style></head><body>";n+=a,n+="</body></html>";var i=new Blob([n],{type:"application/vnd.ms-excel"}),s=e+".xls",r=window.navigator.userAgent;if(r.indexOf("Trident")>=0||r.indexOf("Edge")>=0||r.indexOf("MSIE")>=0)window.navigator.msSaveOrOpenBlob(i,s);else{var l=document.createElement("a");l.href=URL.createObjectURL(i),l.download=s,document.body.appendChild(l),l.click()}}Object.defineProperty(e,"__esModule",{value:!0}),e.getXmlNode=o,e.digui=n,e._typeof=i,e.tableToExcel=s;var r={1300000000:"el-icon-menu",1301000000:"el-icon-setting",1302000000:"el-icon-printer",1303000000:"el-icon-news",1304000000:"el-icon-bell",1305000000:"el-icon-rank",1306000000:"el-icon-view",1307000000:"el-icon-edit-outline",1308000000:"el-icon-picture",1309000000:"el-icon-tickets",1310000000:"el-icon-document",1311000000:"el-icon-star-off",1312000000:"el-icon-date",1313000000:"el-icon-share",1314000000:"el-icon-goods",1315000000:"el-icon-info"}},1249:function(t,e,a){var o=a(1250);"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);a(423)("63124fb6",o,!1)},1250:function(t,e,a){e=t.exports=a(422)(),e.push([t.i,"\n.box[data-v-68bc65c2]{position: relative;width:100%;height: 100%;\n}\n.form[data-v-68bc65c2]{margin:2vh auto;width:98%;\n}\n.tableBox[data-v-68bc65c2]{width:98%;height:82vh;color:#000000;margin:2vh auto;font-size:13px;background: #fff;text-align: center;\n}\n.tableBox h3[data-v-68bc65c2]{color:#26f4ff;font-size:20px;padding:15px 0 5px 0;\n}\n.tableBox .times[data-v-68bc65c2]{color: #26f4ff;font-size: 14px;height:20px;line-height: 20px;margin-bottom:10px;\n}\n.tableBox table[data-v-68bc65c2]{border-spacing: 0;border-collapse: collapse;\n}\n.export-btn[data-v-68bc65c2]{color: #fff;background-color: #409eff;border-color: #409eff;\n}\n.el-form-item[data-v-68bc65c2]{margin-bottom: 0!important;\n}\n.countTable[data-v-68bc65c2]{width:812px;margin:0 auto;\n}\n#longTable[data-v-68bc65c2]{width:1252px;\n}\n.countTable thead[data-v-68bc65c2]{display: inline-block;width: 100%;table-layout: fixed;box-sizing: border-box;\n}\n.countTable thead tr[data-v-68bc65c2]{background:#ddeeff!important;border-top:none!important;\n}\n.countTable tbody[data-v-68bc65c2]{display: inline-block;width: 100%;overflow-y:auto;max-height:30rem;\n}\n.countTable tr[data-v-68bc65c2]{display:inline-block;width:100%;border-top:1px solid #c6c6c6;\n}\n.countTable  th[data-v-68bc65c2],.countTable  td[data-v-68bc65c2]{border-right:1px solid #c6c6c6;text-align: center;\n}\n.countTable  th[data-v-68bc65c2]{border-left:none;border-bottom:none;border-top:none;\n}\n.countTable  th[data-v-68bc65c2]:last-child{border-right:none;\n}\n.countTable tr>td[data-v-68bc65c2]{border-bottom:none;border-left:none;border-top:none;\n}\n.countTable tr>td[data-v-68bc65c2]:last-child{border-right: none;min-width: 203px;\n}\r\n\r\n/* 设置滚动条的样式 */\n[data-v-68bc65c2]::-webkit-scrollbar {\r\nwidth:10px;\n}\r\n/* 滚动槽 */\n[data-v-68bc65c2]::-webkit-scrollbar-track {\r\n-webkit-box-shadow:inset006pxrgba(0,0,0,0.3);\r\nborder-radius:10px;\n}\r\n/* 滚动条滑块 */\n[data-v-68bc65c2]::-webkit-scrollbar-thumb {\r\nborder-radius:10px;\r\nbackground:rgba(0,0,0,0.1);\r\n-webkit-box-shadow:inset006pxrgba(0,0,0,0.5);\n}\r\n",""])},1251:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a(424),n=function(t){return t&&t.__esModule?t:{default:t}}(o),i=a(1099);e.default={props:{valueArr:{default:function(){return["01-03","04-06","07-09","10-12"]},type:Array},getValue:{default:function(){},type:Function},defaultValue:{default:"",type:String}},data:function(){return{options:[{value:"1",label:"巡线承揽单位考核"},{value:"2",label:"巡线承揽人考核"},{value:"3",label:"线路区段长考核"}],form:{AREAID:"",STATIONID:"",dateTime:""},types:"",showSeason:!1,season:"",year:(new Date).getFullYear(),showValue:"",placelist:[],stationlist:[],areaName:"",stationName:"",typesName:"",data:[],showTime:!1,showNum:!1,showTable:!1,showExport:!1}},created:function(){if(this.defaultValue){var t=this.defaultValue,e=t.split("-");this.year=e[0].slice(0,4);var a=e[0].slice(4,6)+"-"+e[1].slice(4,6),o=this.valueArr;this.showValue=this.year+"年"+(o.indexOf(a)+1)+"季度"}},watch:{defaultValue:function(t,e){var a=t.split("-");this.year=a[0].slice(0,4);var o=a[0].slice(4,6)+"-"+a[1].slice(4,6),n=this.valueArr;this.showValue=this.year+"年"+(n.indexOf(o)+1)+"季度"},$route:function(t,e){t.path!=e.path&&this.init()}},mounted:function(){this.init()},methods:{init:function(){this.form.AREAID="",this.form.dateTime="",this.getAllArea(),this.changePlace(this.form.AREAID)},getAllArea:function(){var t=this,e="gpsGroups/getAllArea?userId="+this.$Cookie.get("userId");this.$myHttp.get(e).then(function(e){t.placelist=e.result}),this.data=[]},changePlace:function(t){var e=this;this.form.STATIONID="";var a="gpsGroups/getStationsByArea?userId="+this.$Cookie.get("userId")+"&groupCode="+t;this.$myHttp.get(a).then(function(t){e.stationlist=t.result}),this.data=[],this.typesName="",this.areaName="",this.stationName="",this.showTime=!1,this.showTable=!1,this.showExport=!1},changeTypes:function(){this.data=[],this.form.AREAID="",this.form.STATIONID="",this.typesName="",this.areaName="",this.stationName="",this.showTime=!1,this.stationlist=[],this.showTable=!1,this.showExport=!1},changeStation:function(){this.data=[],this.typesName="",this.areaName="",this.stationName="",this.showTime=!1,this.showTable=!1,this.showExport=!1},search:function(){var t=this;this.data.length=0;var e="";if(e=3==this.types?this.showValue:this.form.dateTime,""==this.types||""==e)window.vm.$message({type:"error",message:"请选择排名类型，日期",showClose:!0,duration:2e3});else{this.showTime=!0,this.options.map(function(e){t.types==e.value&&(t.typesName=e.label)}),this.placelist.map(function(e){t.form.AREAID==e.GROUPCODE&&("全部"!=e.GROUPNAME?t.areaName=e.GROUPNAME:t.areaName="")}),this.stationlist.map(function(e){t.form.STATIONID==e.GROUPCODE&&("全部"!=e.GROUPNAME?t.stationName=e.GROUPNAME:t.stationName="")});var a="",o={};1==this.types?(a="contractor/getContractorStat",o={areaId:this.form.AREAID,queryDate:this.form.dateTime}):2==this.types?(a="contractorMan/getContractManStat",o={areaId:this.form.AREAID,stationId:this.form.STATIONID,queryDate:this.form.dateTime}):(a="pipeManaExam/getPipeManaExamStat",o={areaId:this.form.AREAID,season:this.season,stationId:this.form.STATIONID,year:this.year});var i={headers:{"content-type":"application/json"}};this.$myHttp.post(a,(0,n.default)(o),i).then(function(e){if(null!=e.result){var a=e.result;1==t.types?""==t.form.AREAID?(t.showNum=!0,a.map(function(e){null!=e.MUSTNUM&&"管道管理处"!=e.NAME&&t.data.push(e)})):(t.showNum=!1,a.map(function(e){"管道管理处"!=e.NAME&&t.data.push(e)})):""==t.form.STATIONID?(t.showNum=!0,a.map(function(e){null!=e.MUSTNUM&&"管道管理处"!=e.NAME&&t.data.push(e)})):(t.showNum=!1,a.map(function(e){"管道管理处"!=e.NAME&&t.data.push(e)})),console.log(a),console.log(t.data)}}),this.showExport=!0,this.showTable=!0}},exportToExcel:function(){(0,i.tableToExcel)("tableExport","巡检质量排名统计")},selectTime:function(t){this.data=[],this.typesName="",this.areaName="",this.stationName="",this.showTable=!1,this.showExport=!1},one:function(){this.showSeason=!1},prev:function(){this.year=1*this.year-1},next:function(){this.year=1*this.year+1},selectSeason:function(t){var e=this;e.season=t+1;var a=e.valueArr[t].split("-");e.getValue(e.year+a[0]+"-"+e.year+a[1]),e.showSeason=!1,this.showValue=this.year+"年"+this.season+"季度",this.data=[],this.typesName="",this.areaName="",this.stationName="",this.showTime=!1,this.showTable=!1,this.showExport=!1},getId:function(t){return 1==t?"longTable":"shortTable"}},filters:{twoNumber:function(t){return t=Number(t),t.toFixed(2)}}}},1252:function(t,e,a){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box"},[a("el-form",{staticClass:"form",attrs:{inline:!0,model:t.form}},[a("el-form-item",{attrs:{label:"考核类型"}},[a("el-select",{attrs:{size:"small",placeholder:"请选择考核类型"},on:{change:t.changeTypes},model:{value:t.types,callback:function(e){t.types=e},expression:"types"}},t._l(t.options,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"输油处：",prop:"AREAID"}},[a("el-select",{attrs:{size:"small",placeholder:"请选择输油处"},on:{change:t.changePlace},model:{value:t.form.AREAID,callback:function(e){t.$set(t.form,"AREAID",e)},expression:"form.AREAID"}},t._l(t.placelist,function(t){return a("el-option",{key:t.GROUPCODE,attrs:{label:t.GROUPNAME,value:t.GROUPCODE}})}))],1),t._v(" "),1!=t.types?[a("el-form-item",{attrs:{label:"输油站：",prop:"STATIONID"}},[a("el-select",{attrs:{size:"small",placeholder:"请选择输油站"},on:{change:t.changeStation},model:{value:t.form.STATIONID,callback:function(e){t.$set(t.form,"STATIONID",e)},expression:"form.STATIONID"}},t._l(t.stationlist,function(t){return a("el-option",{key:t.GROUPCODE,attrs:{label:t.GROUPNAME,value:t.GROUPCODE}})}))],1)]:t._e(),t._v(" "),3==t.types?[a("el-form-item",{attrs:{label:"日期："}},[a("mark",{directives:[{name:"show",rawName:"v-show",value:t.showSeason,expression:"showSeason"}],staticStyle:{position:"fixed",top:"0",bottom:"0",left:"0",right:"0",background:"rgba(0,0,0,0)","z-index":"999"},on:{click:function(e){e.stopPropagation(),t.showSeason=!1}}}),t._v(" "),a("el-input",{staticClass:"jidu",staticStyle:{width:"138px"},attrs:{placeholder:"请选择季度"},on:{focus:function(e){t.showSeason=!0}},model:{value:t.showValue,callback:function(e){t.showValue=e},expression:"showValue"}},[a("i",{staticClass:"el-input__icon el-icon-date",attrs:{slot:"prefix"},slot:"prefix"})]),t._v(" "),a("el-card",{directives:[{name:"show",rawName:"v-show",value:t.showSeason,expression:"showSeason"}],staticClass:"box-card",staticStyle:{width:"322px",padding:"0 3px 20px","margin-top":"10px",position:"fixed","z-index":"9999"}},[a("div",{staticClass:"clearfix",staticStyle:{"text-align":"center",padding:"0"},attrs:{slot:"header"},slot:"header"},[a("button",{staticClass:"el-picker-panel__icon-btn el-date-picker__prev-btn el-icon-d-arrow-left",attrs:{type:"button","aria-label":"前一年"},on:{click:t.prev}}),t._v(" "),a("span",{staticClass:"el-date-picker__header-label",attrs:{role:"button"}},[t._v(t._s(t.year)+"年")]),t._v(" "),a("button",{staticClass:"el-picker-panel__icon-btn el-date-picker__next-btn el-icon-d-arrow-right",attrs:{type:"button","aria-label":"后一年"},on:{click:t.next}})]),t._v(" "),a("div",{staticClass:"text item",staticStyle:{"text-align":"center"}},[a("el-button",{staticStyle:{width:"40%",color:"#606266",float:"left"},attrs:{type:"text",size:"medium"},on:{click:function(e){t.selectSeason(0)}}},[t._v("第一季度")]),t._v(" "),a("el-button",{staticStyle:{float:"right",width:"40%",color:"#606266"},attrs:{type:"text",size:"medium"},on:{click:function(e){t.selectSeason(1)}}},[t._v("第二季度")])],1),t._v(" "),a("div",{staticClass:"text item",staticStyle:{"text-align":"center"}},[a("el-button",{staticStyle:{width:"40%",color:"#606266",float:"left"},attrs:{type:"text",size:"medium"},on:{click:function(e){t.selectSeason(2)}}},[t._v("第三季度")]),t._v(" "),a("el-button",{staticStyle:{float:"right",width:"40%",color:"#606266"},attrs:{type:"text",size:"medium"},on:{click:function(e){t.selectSeason(3)}}},[t._v("第四季度")])],1)])],1)]:[a("el-form-item",{attrs:{label:"日期：",prop:"dateTime"}},[a("el-date-picker",{attrs:{size:"small",type:"month",placeholder:"选择日期",format:"yyyy-MM","value-format":"yyyy-MM"},on:{change:t.selectTime},model:{value:t.form.dateTime,callback:function(e){t.$set(t.form,"dateTime",e)},expression:"form.dateTime"}})],1)],t._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){t.search()}}},[t._v("查询")])],1),t._v(" "),a("el-form-item",[a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.showExport,expression:"showExport"}],attrs:{size:"small",type:"primary"},on:{click:t.exportToExcel}},[t._v("导出")])],1)],2),t._v(" "),a("div",{staticClass:"tableBox"},[a("h3",[t._v("国家石油天然气管网集团有限公司华南分公司"+t._s(t.areaName)+t._s(t.stationName)+t._s(t.typesName))]),t._v(" "),1==t.showTime?a("div",{staticClass:"times"},[3==t.types?[a("p",[t._v(t._s(t.showValue))])]:[a("p",[t._v(t._s(t.form.dateTime))])]],2):a("div",{staticClass:"times"}),t._v(" "),a("div",{staticStyle:{height:"85%"},attrs:{id:"tableExport"}},[a("div",{staticStyle:{"overflow-x":"auto"}},[a("table",{directives:[{name:"show",rawName:"v-show",value:t.showTable,expression:"showTable"}],staticClass:"countTable",attrs:{border:"1",bordercolor:"#c6c6c6",id:t.getId(t.showNum)}},[a("thead",[a("tr",[a("th",{attrs:{width:"220px"}},[t._v("排名")]),t._v(" "),a("th",{attrs:{width:"370px"}},[t._v("分组名")]),t._v(" "),t.showNum?[a("th",{attrs:{width:"220px"}},[t._v("应考核数量")]),t._v(" "),a("th",{attrs:{width:"220px"}},[t._v("实际考核数量")])]:t._e(),t._v(" "),a("th",{attrs:{width:"220px"}},[t._v("考核分数")])],2)]),t._v(" "),a("tbody",t._l(t.data,function(e,o){return a("tr",{key:o},[a("td",{attrs:{width:"220px"}},[t._v(t._s(o+1))]),t._v(" "),a("td",{attrs:{width:"370px"}},[t._v(t._s(e.NAME))]),t._v(" "),t.showNum?[a("td",{attrs:{width:"220px"}},[t._v(t._s(e.MUSTNUM))]),t._v(" "),a("td",{attrs:{width:"220px"}},[t._v(t._s(e.NUM))])]:t._e(),t._v(" "),a("td",[t._v(t._s(t._f("twoNumber")(e.AVG)))])],2)}))])])])])],1)},staticRenderFns:[]},t.exports.render._withStripped=!0},441:function(t,e,a){a(1249);var o=a(265)(a(1251),a(1252),"data-v-68bc65c2",null);o.options.__file="D:\\website\\src\\views\\ywbb\\rank.vue",o.esModule&&Object.keys(o.esModule).some(function(t){return"default"!==t&&"__esModule"!==t})&&console.error("named exports are not supported in *.vue files."),o.options.functional&&console.error("[vue-loader] rank.vue: functional components are not supported with templates, they should use render functions."),t.exports=o.exports}});